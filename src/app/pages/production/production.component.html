<!-- selection criteria -->

<div class="dashboard-left" id="dashboard-left">
  <nb-card accent="primary" id="selection-criteria-section" (click)="searchCriteriaExpand()">

    <nb-card-header class="border-bottom d-flex" [ngClass]="times > 0?'timerActive':''">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="mr-2" fill="#2a2a2a"><rect width="24" height="24" opacity="0"></rect><path d="M20.71 19.29l-3.4-3.39A7.92 7.92 0 0 0 19 11a8 8 0 1 0-8 8 7.92 7.92 0 0 0 4.9-1.69l3.39 3.4a1 1 0 0 0 1.42 0 1 1 0 0 0 0-1.42zM5 11a6 6 0 1 1 6 6 6 6 0 0 1-6-6z"></path></svg>
      <span>{{language.selection_criteria}}</span>
      <!--<span *ngIf="times" class="ml-auto"><countdown #countdown  [config]="{leftTime: times}">$!m!:$!s!</countdown></span>-->
    </nb-card-header>

    <nb-card-body id="selection-criteria-body" class="pt-0 justify-content-between flex-direction-column flex-box">
      <div class="row">
        <div class="col-sm-12">
          <form #criteriaForm="ngForm">

            <fieldset class="form-group px-0 mb-2">
              <nb-radio-group class="d-flex" name="radioExplode" [(ngModel)]="viewOption">
                <nb-radio *ngFor="let viewOption of viewOptions" [value]="viewOption.value"> {{ viewOption.label }}
                </nb-radio>
              </nb-radio-group>
            </fieldset>

            <h6 class="border-bottom pb-1 mb-3 ">Select</h6>

            <div class="form-group">
              <label for="ItemFrom" class="form-label">Item From</label>
              <div class="w-100">
                <div class="input-group">
                  <input nbInput fieldSize="small" type="text" name="ItemCodeFrom" id="ItemCodeFrom" class="form-control"
                     #ItemCF=ngModel [(ngModel)]="ItemCodeFrom" placeholder="Item From" (blur)="onItemFromBlur()" autocomplete="off">
                  <div class="input-group-append">
                    <button type="submit" class="btn btn-primary btn-icon-with-input" nbButton size="xsmall" (click)="openItemFromLookup(dialog)"><i class="optipro-icon-hamburger"></i></button>
                  </div>
                </div>
              </div> 
              <small id="emailHelp" class="form-text text-muted opti_error-msg" *ngIf="itemFromStatus && ItemCF.touched" class="float-right opti_error-msg">Enter correct item code</small>  
            </div>

            <div class="form-group">
              <label for="ItemTo" class="form-label">Item To</label>
              <div class="w-100">
                <div class="input-group">
                  <input nbInput fieldSize="small" type="text" name="ItemCodeTo" id="ItemCodeTo" class="form-control" 
                   #ItemCT=ngModel [(ngModel)]="ItemCodeTo" placeholder="Item To" (blur)="onItemToBlur()" autocomplete="off">
                  <div class="input-group-append">
                    <button type="submit" class="btn btn-primary btn-icon-with-input" nbButton size="xsmall" (click)="openItemToLookup(dialog)"><i class="optipro-icon-hamburger"></i></button>
                  </div>
                </div>
              </div>
              <small id="emailHelp" class="form-text text-muted opti_error-msg" *ngIf="itemToStatus && ItemCT.touched" class="float-right opti_error-msg">Enter correct item code</small>  
            </div>

            <div class="form-group">
              <label for="fromDate" class="form-label">WO Date From</label>
              <div class="w-100">
                <input name="fromDate" id="fromDate" fieldSize="small" nbInput type="text" class="form-control datepicker" [nbDatepicker]="fromPicker" [(ngModel)]="FromDate" readonly>
                <nb-datepicker #fromPicker></nb-datepicker>
              </div>
            </div>

            <div class="form-group">
              <label for="inputPassword3" class="form-label">WO Date To</label>
              <div class="w-100">
                <input fieldSize="small" nbInput type="text" name="fromTo" id="fromTo" class="form-control datepicker" [nbDatepicker]="toPicker" [(ngModel)]="ToDate" readonly>
                <nb-datepicker #toPicker></nb-datepicker>
              </div>
            </div>

            <h6 class="border-bottom pb-1 mb-1 mt-3">WO Status</h6>

            <div class="form-group mt-3 px-0 d-flex flex-wrap">
              <div class="k-form-field pr-4 pb-2">
                  <input type="checkbox" id="all" class="k-checkbox" name="WO_Status" [(ngModel)]="masterSelected" (change)="checkUncheckAll()"
                  />
                  <label class="k-checkbox-label" for="all">All</label>
                </div>
                <div class="k-form-field pr-4 pb-2" *ngFor="let item of checklist">
                  <input type="checkbox" id="{{item.id}}" class="k-checkbox" [(ngModel)]="item.isSelected" name="list_name" value="{{item.id}}" (change)="isAllSelected()"/>

                  <label class="k-checkbox-label" for="{{item.id}}">{{item.name}}</label>
                </div>
                <small id="emailHelp" class="form-text text-muted opti_error-msg" *ngIf="checkboxStatus" class="float-right opti_error-msg">Select at least one WO status</small>
            </div> 
          </form>
        </div>
      </div>

     <!-- <div class="row ">
        <div class="col-12 d-flex justify-content-between align-items-center">
            <div class="k-form-field d-flex align-items-center">
              <input type="checkbox" class="k-checkbox" id="autorefreshTime" name="autorefreshTime" [(ngModel)]="refreshCheck" (click)="refreshEvent($event)"/>
              <label class="k-checkbox-label d-flex align-items-center" for="autorefreshTime">Auto refresh time 
                <input name="customTime" [(ngModel)]="time" id="customTime" fieldSize="small" nbInput type="text" class="form-control w-auto text-center" style="padding: 0 2px;max-width: 20px;height: 20px;margin: 0 5px;" [disabled]="!refreshStatus"> minute.</label>
            </div>
            <button class="btn btn-default btn-icon btn-sm p-0 btn-icon-only" title="Manual Refresh" (click)="autoRefresh();"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#212529" viewBox="0 0 24 24"><g data-name="Layer 2"><g data-name="sync"><rect width="24" height="24" opacity="0"></rect><path d="M21.66 10.37a.62.62 0 0 0 .07-.19l.75-4a1 1 0 0 0-2-.36l-.37 2a9.22 9.22 0 0 0-16.58.84 1 1 0 0 0 .55 1.3 1 1 0 0 0 1.31-.55A7.08 7.08 0 0 1 12.07 5a7.17 7.17 0 0 1 6.24 3.58l-1.65-.27a1 1 0 1 0-.32 2l4.25.71h.16a.93.93 0 0 0 .34-.06.33.33 0 0 0 .1-.06.78.78 0 0 0 .2-.11l.08-.1a1.07 1.07 0 0 0 .14-.16.58.58 0 0 0 .05-.16z"></path><path d="M19.88 14.07a1 1 0 0 0-1.31.56A7.08 7.08 0 0 1 11.93 19a7.17 7.17 0 0 1-6.24-3.58l1.65.27h.16a1 1 0 0 0 .16-2L3.41 13a.91.91 0 0 0-.33 0H3a1.15 1.15 0 0 0-.32.14 1 1 0 0 0-.18.18l-.09.1a.84.84 0 0 0-.07.19.44.44 0 0 0-.07.17l-.75 4a1 1 0 0 0 .8 1.22h.18a1 1 0 0 0 1-.82l.37-2a9.22 9.22 0 0 0 16.58-.83 1 1 0 0 0-.57-1.28z"></path></g></g></svg></button>
        </div>
      </div>-->


    </nb-card-body>
    <nb-card-footer class="text-center py-2">
      <button type="submit" nbButton class="btn btn-primary btn-with-icon-right" size="small" (click)="GetExplosionData($event)" [disabled]="!criteriaForm.form.valid || (itemFromStatus || itemToStatus)">Process <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="ml-2" fill="#fff"><rect width="24" height="24" transform="rotate(-90 12 12)" opacity="0"></rect><path d="M5 13h11.86l-3.63 4.36a1 1 0 0 0 1.54 1.28l5-6a1.19 1.19 0 0 0 .09-.15c0-.05.05-.08.07-.13A1 1 0 0 0 20 12a1 1 0 0 0-.07-.36c0-.05-.05-.08-.07-.13a1.19 1.19 0 0 0-.09-.15l-5-6A1 1 0 0 0 14 5a1 1 0 0 0-.64.23 1 1 0 0 0-.13 1.41L16.86 11H5a1 1 0 0 0 0 2z"></path></svg></button>
    </nb-card-footer>
  </nb-card>

  <ng-template #dialog let-data let-ref="dialogRef">
    <nb-card style="max-width:700px">
      <nb-card-header class="d-flex justify-content-between">
        <span>{{lookUpHeading}}</span>
        <span (click)="ref.close()" class="cursor-pointer">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"
            class="eva eva-close-outline mr-2 cursor-pointer" fill="#2a2a2a">
            <rect width="24" height="24" transform="rotate(180 12 12)" opacity="0"></rect>
            <path
              d="M13.41 12l4.3-4.29a1 1 0 1 0-1.42-1.42L12 10.59l-4.29-4.3a1 1 0 0 0-1.42 1.42l4.3 4.29-4.3 4.29a1 1 0 0 0 0 1.42 1 1 0 0 0 1.42 0l4.29-4.3 4.29 4.3a1 1 0 0 0 1.42 0 1 1 0 0 0 0-1.42z">
            </path>
          </svg>
        </span>
      </nb-card-header>
      <nb-card-body>
        <div>
          <kendo-grid [kendoGridBinding]="gridData" [selectable]="selectableSettings" [filterable]=isColumnFilter1
            [groupable]=isColumnGroup [selectable]="true" [sort]="state.sort" [filter]="state.filter" [resizable]="true"
            (selectionChange)="gridRowSelectionChange($event,ref)"
            [ngStyle]="{ 'cursor': 'pointer', 'max-height':'290px'}">
            <!-- grid template start -->
            <ng-template kendoGridToolbarTemplate>
              <!-- checkbox -->
              <form class="k-form opti_show-hide-grid-column-filter float-left opti_hide-in-mobile pl-0 pt-0">
                <div class="k-form-field d-flex">
                  <input #chkFilter1 type="checkbox" (change)="onFilterChange(chkFilter1,gridItem1)"
                    id="opti_SalesOrderListColumnFilterID1" [(ngModel)]="isColumnFilter1" class="k-checkbox"
                    name="columnfilter" />
                  <label class="k-checkbox-label" for="opti_SalesOrderListColumnFilterID1">Enable Filter</label>
                </div>
              </form>
            </ng-template>
            
            <kendo-grid-checkbox-column *ngIf="showSelection==true" title="Select" [width]="25">
              <ng-template kendoGridCellTemplate let-idx='rowIndex' let-di='dataItem'>
                <div class="k-form-field d-flex center-checkbox">
                  <input #chkSelection type="checkbox" [disabled]='di.OldData' [checked]='di.OldData'
                    (change)="onCheckboxClick(chkSelection.checked,idx)" id="chkbox-{{idx}}" class="k-checkbox"
                    name="columnfilter" />

                  <label class="k-checkbox-label" for="chkbox-{{idx}}"></label>
                </div>
              </ng-template>
            </kendo-grid-checkbox-column>

            <kendo-grid-column field="ItemCode" title="Item Code" width="80">
            </kendo-grid-column>

            <kendo-grid-column field="ItemName" title="Description" width="80">
            </kendo-grid-column>
          </kendo-grid>


        </div>
      </nb-card-body>
      <nb-card-footer>
        <button nbButton (click)="ref.close()" size="small">Close</button>
      </nb-card-footer>
    </nb-card>
  </ng-template>
</div>
<!--End selection criteria -->



<div class="dashboard-right">
  <div class="custom-accordian grid-accordian-open" id="custom-accordian">
    <div class="grid-accordian expanded" id="grid-accordian">
      <nb-card accent="primary" size="xsmall" [nbSpinner]="loading" nbSpinnerStatus="primary" nbSpinnerSize="xlarge"
        nbSpinnerMessage="Please Wait">
        <nb-card-header class="border-bottom d-flex" id="grid-accordian-trigger" (click)="customAccordianGrid($event)">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="mr-2" fill="#2a2a2a"><rect width="24" height="24" opacity="0"></rect><path d="M9 3H5a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h4a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2z"></path><path d="M19 3h-4a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h4a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2z"></path><path d="M9 13H5a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h4a2 2 0 0 0 2-2v-4a2 2 0 0 0-2-2z"></path><path d="M19 13h-4a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h4a2 2 0 0 0 2-2v-4a2 2 0 0 0-2-2z"></path></svg>
            <span>Grid View</span>
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="eva-arrow-ios-downward ml-auto cursor-pointer" fill="#2a2a2a"><rect width="24" height="24" opacity="0"></rect><path d="M12 16a1 1 0 0 1-.64-.23l-6-5a1 1 0 1 1 1.28-1.54L12 13.71l5.36-4.32a1 1 0 0 1 1.41.15 1 1 0 0 1-.14 1.46l-6 4.83A1 1 0 0 1 12 16z"></path></svg>
        </nb-card-header>
        <nb-card-body class="py-0" id="grid-accordian-body">
          <div class="row h-100 flex-100">

            <!-- Start Grid View -->

            <div class="col-sm-4 border-right overflow-auto h-100">
              <div class="
              View pt-3" *ngIf="showView == 'simple'">
                <kendo-grid [kendoGridBinding]="gridViewData" [selectable]="selectableSettings"
                  [groupable]=isColumnGroup [selectable]="true" [sort]="state.sort" [resizable]="true"
                  (selectionChange)="gridRowSelectFG($event)"
                  [ngStyle]="{ 'cursor': 'pointer', 'max-height':'290px'}">
      
                  <kendo-grid-column field="ItemCode" title="Item" width="80">
                  </kendo-grid-column>      
                  <kendo-grid-column field="OnHand" title="In Stock" width="80" class="text-right" headerClass="text-right">
                  </kendo-grid-column>
                  <kendo-grid-column field="IsCommited" title="Committed" width="80" class="text-right" headerClass="text-right">
                  </kendo-grid-column>
                  <kendo-grid-column field="OnOrder" title="On Order" width="80" class="text-right" headerClass="text-right">
                  </kendo-grid-column>
                  <kendo-grid-column field="AVAILABLE" title="Available Quantity" width="80" class="text-right" headerClass="text-right">
                  </kendo-grid-column>                  
                  <kendo-grid-column field="U_O_UOM" title="UOM" width="80" class="text-right" headerClass="text-right">
                  </kendo-grid-column>

                </kendo-grid>
              </div>

              <div class="tree-wrapper pt-3" *ngIf="showView == 'detail'">
                <!--<app-treetable></app-treetable>-->
                <div class="content-section implementation">  
                  <p-treeTable [value]="files2" [scrollable]="true" scrollHeight="200px" [resizableColumns]="true" columnResizeMode="expand">
                    <ng-template pTemplate="colgroup">
                      <colgroup>
                        <col>
                        <col>
                        <col>
                        <col>
                        <col>
                      </colgroup>
                    </ng-template>
                    <ng-template pTemplate="header">
                      <tr>
                        <th ttResizableColumn>Item</th>
                        <th ttResizableColumn>In Stock</th>
                        <th ttResizableColumn>Commited</th>
                        <th ttResizableColumn>On Order</th>
                        <th ttResizableColumn>Available Quantity</th>
                        <th ttResizableColumn>UOM</th>
                      </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-rowNode let-rowNodeIndex="rowNodeIndex"  let-rowData="rowData">
                        <tr [ttRow]="rowNode" (click)="ItemRowSelect(rowData)">
                            <td>
                                <p-treeTableToggler [rowNode]="rowNode" class="cursor-pointer"></p-treeTableToggler>
                                <span class="cursor-pointer">{{rowData.ItemCode}}</span>
                            </td>
                            <td class="text-right" headerClass="text-right">{{rowData.OnHand}}</td>
                            <td class="text-right" headerClass="text-right">{{rowData.IsCommited}}</td>
                            <td class="text-right" headerClass="text-right">{{rowData.OnOrder}}</td>
                            <td class="text-right" headerClass="text-right">{{rowData.AVAILABLE}}</td>
                            <td class="text-right" headerClass="text-right">{{rowData.U_O_UOM}}</td>
                        </tr>
                    </ng-template>
                </p-treeTable>
                </div>
              </div>

            </div>
            <!-- End Grid View -->

            <!-- Selected FG Grid-->

            <div class="col-sm-8 pt-2 overflow-auto h-100">
              <div>
                <nb-radio-group class="d-flex flex-wrap" [(ngModel)]="RadioBtnWO" name="RadioBtnWO" (valueChange)="getWoRadioClick($event)">
                  <nb-radio [value]="'simple'">Show WO for selected FG</nb-radio>
                  <nb-radio [value]="'all'">Show WOs for all sub assemblies for selected FG</nb-radio>  
                </nb-radio-group>
              </div>

              <div class="mt-2">
                <kendo-grid [kendoGridBinding]="gridWOFG" [selectable]="selectableSettings" [filterable]=isColumnFilter2
                  [groupable]=isColumnGroup [pageable]="true" [pageSize]="10" [selectable]="true" [sort]="state.sort" [filter]="state.filter" [resizable]="true"
                  (selectionChange)="gridRowSelectDocEntry($event)"
                  [ngStyle]="{ 'max-height':'490px'}">
                  <ng-template kendoGridToolbarTemplate>
                    <form class="k-form opti_show-hide-grid-column-filter float-left opti_hide-in-mobile pl-0 pt-0">
                      <div class="k-form-field d-flex">
                        <input #chkFilter2 type="checkbox" (change)="onFilterChange(chkFilter2,gridWOFG)"
                          id="opti_SalesOrderListColumnFilterID2" [(ngModel)]="isColumnFilter2" class="k-checkbox"
                          name="columnfilter" />
                        <label class="k-checkbox-label" for="opti_SalesOrderListColumnFilterID2">Enable Filter</label>
                      </div>
                    </form>
      
                  </ng-template>
                  <kendo-grid-checkbox-column *ngIf="showSelection==true" title="Select" [width]="25">
                    <ng-template kendoGridCellTemplate let-idx='rowIndex' let-di='dataItem'>
                      <div class="k-form-field d-flex center-checkbox">
                        <input #chkSelection type="checkbox" [disabled]='di.OldData' [checked]='di.OldData'
                          (change)="onCheckboxClick(chkSelection.checked,idx)" id="chkbox-{{idx}}" class="k-checkbox"
                          name="columnfilter" />      
                        <label class="k-checkbox-label" for="chkbox-{{idx}}"></label>
                      </div>
                    </ng-template>
                  </kendo-grid-checkbox-column>

                  <kendo-grid-column field="DocEntry" title="Doc Entry" width="54" class="text-right" headerClass="text-right">
                  </kendo-grid-column> 
                  <kendo-grid-column field="U_OPTM_PRIORITY" title="Priority" width="54" class="text-right" headerClass="text-right">
                  </kendo-grid-column>      
                  <kendo-grid-column field="U_O_ORDRNO" title="WO#" width="44" class="text-right" headerClass="text-right">
                  </kendo-grid-column>
                  <!-- <kendo-grid-column field="Status" title="Status" width="52">
                  </kendo-grid-column> -->
                  <kendo-grid-column field="WO_STATUS" title="WO Status" width="70" class="text-right" headerClass="text-right">
                    </kendo-grid-column>
                  <kendo-grid-column field="U_O_PRODID" title="Product No." width="81">
                  </kendo-grid-column>
                  <kendo-grid-column field="U_O_PRODDESC" title="Product Description" width="89">
                  </kendo-grid-column>
                  <kendo-grid-column field="U_O_SONO" title="SO No." width="54" class="text-right" headerClass="text-right">
                  </kendo-grid-column>      
                  <kendo-grid-column field="U_O_CUSTCODE" title="Customer" width="70">
                  </kendo-grid-column>
                  <kendo-grid-column field="U_O_STARTDATE" title="Schedule Start Date" width="97">
                      <ng-template kendoGridCellTemplate let-dataItem>
                          {{dataItem.U_O_STARTDATE | date: 'MM/dd/yyyy'}}
                      </ng-template>
                  </kendo-grid-column>
                  <kendo-grid-column field="U_O_ENDDATE" title="Schedule End Date" width="97">
                      <ng-template kendoGridCellTemplate let-dataItem>
                          {{dataItem.U_O_ENDDATE | date: 'MM/dd/yyyy'}}
                      </ng-template>
                  </kendo-grid-column>
                  <kendo-grid-column field="U_O_UOM" title="UOM" width="44">
                  </kendo-grid-column>
                  <kendo-grid-column field="U_O_ORDRQTY" title="Quantity Order" width="57" class="text-right" headerClass="text-right">
                  </kendo-grid-column>      
                  <kendo-grid-column field="U_O_POSTEDQTY" title="Quantity Complete" width="90" class="text-right" headerClass="text-right">
                      <ng-template kendoGridCellTemplate let-dataItem>
                          <a class="cursor-pointer text-primary" (click)="showDetailCompleteLookup(dataItem)">{{dataItem.U_O_POSTEDQTY}}</a>
                      </ng-template>
                  </kendo-grid-column>
                  <kendo-grid-column field="U_O_PASSEDQTY" title="Quantity Accept" width="65" class="text-right" headerClass="text-right">
                  </kendo-grid-column>
                  <kendo-grid-column field="U_O_REJQTY" title="Quantity Reject" width="71" class="text-right" headerClass="text-right">
                  </kendo-grid-column>
                  <kendo-grid-column field="BALANCE_QTY" title="Quantity Balance" width="55" class="text-right" headerClass="text-right">
                  </kendo-grid-column>
                  <kendo-grid-column field="COMPLETEPERCENT" title="% Complete" width="68" class="text-right" headerClass="text-right">
                  </kendo-grid-column>      
                  <kendo-grid-column field="U_O_FGWHSEID" title="Warehouse" width="40" class="text-right" headerClass="text-right">
                  </kendo-grid-column>
                  <kendo-grid-column field="U_O_BOMSEQ" title="BOM Sequence" width="67" class="text-right" headerClass="text-right">
                  </kendo-grid-column>
                  <kendo-grid-column field="U_O_RUTNGSEQ" title="Route Sequence" width="66" class="text-right" headerClass="text-right">
                  </kendo-grid-column>
                  <kendo-grid-column field="ComponentCost" title="Component Cost" width="107" class="text-right" headerClass="text-right">
                  </kendo-grid-column>
                  <kendo-grid-column field="ResourceCost" title="Resource Cost" width="95" class="text-right" headerClass="text-right">
                  </kendo-grid-column>
                  <kendo-grid-column field="ActualCost" title="Actual Product Cost" width="124" class="text-right" headerClass="text-right">
                  </kendo-grid-column>
                  <kendo-grid-column field="Variance" title="Variance" width="70" class="text-right" headerClass="text-right">
                  </kendo-grid-column>                  
                  
                </kendo-grid>
              </div>
              
              <!-- Grid -->

              <nb-card class="mt-4 no-shadow border border-light-gray">
                <nb-card-body class="p-0">
                  <nb-tabset (changeTab)="toggleLoadingAnimation()">
                    <nb-tab tabTitle="Material" [nbSpinner]="Tabloading" nbSpinnerStatus="primary" nbSpinnerSize="xxlarge"
                    nbSpinnerMessage="Please Wait">
                      <div class="py-3 px-2">
                        <div class="pl-2">
                            <nb-radio-group class="d-flex" [(ngModel)]="materialViewOption" (valueChange)="getMaterialRadioClick($event)">
                              <nb-radio [value]="'immediate'" >Show Immediate Components</nb-radio>
                              <nb-radio [value]="'all'">Show Components for all the Subassemblies</nb-radio>
                            </nb-radio-group>
                        </div>
                        <div class="mt-4" *ngIf="showMaterialView == 'immediate'">
                          <kendo-grid [kendoGridBinding]="gridMaterial" [selectable]="selectableSettings" [filterable]=isColumnFilter3
                            [groupable]=isColumnGroup [pageable]="true" [pageSize]="10" [selectable]="true" [sort]="state.sort" [filter]="state.filter" [resizable]="true"
                            [ngStyle]="{ 'max-height':'490px'}">
                            <ng-template kendoGridToolbarTemplate>
                              <form class="k-form opti_show-hide-grid-column-filter float-left opti_hide-in-mobile pl-0 pt-0">
                                <div class="k-form-field d-flex">
                                  <input #chkFilter3 type="checkbox" (change)="onFilterChange(chkFilter3,gridMaterial)"
                                    id="opti_SalesOrderListColumnFilterID3" [(ngModel)]="isColumnFilter3" class="k-checkbox"
                                    name="columnfilter" />
                                  <label class="k-checkbox-label" for="opti_SalesOrderListColumnFilterID3">Enable Filter</label>
                                </div>
                              </form>                
                            </ng-template>

                            <kendo-grid-checkbox-column *ngIf="showSelection==true" title="Select" [width]="25">
                              <ng-template kendoGridCellTemplate let-idx='rowIndex' let-di='dataItem'>
                                <div class="k-form-field d-flex center-checkbox">
                                  <input #chkSelection type="checkbox" [disabled]='di.OldData' [checked]='di.OldData'
                                    (change)="onCheckboxClick(chkSelection.checked,idx)" id="chkbox-{{idx}}" class="k-checkbox"
                                    name="columnfilter" />      
                                  <label class="k-checkbox-label" for="chkbox-{{idx}}"></label>
                                </div>
                              </ng-template>
                            </kendo-grid-checkbox-column>

                            <kendo-grid-column field="U_O_COMPID" title="Component" width="79">
                            </kendo-grid-column>      
                            <kendo-grid-column field="U_O_ITEMDESC" title="Description" width="78">
                            </kendo-grid-column>
                            <kendo-grid-column field="U_O_UOM" title="UOM" width="44">
                            </kendo-grid-column>
                            <kendo-grid-column field="REQ_QTY" title="Quantity Request" width="59" class="text-right" headerClass="text-right">
                            </kendo-grid-column>
                            <kendo-grid-column field="U_O_ACTISSQTY" title="Quantity Issue" width="74" class="text-right" headerClass="text-right">
                                <ng-template kendoGridCellTemplate let-dataItem>
                                    <a class="cursor-pointer text-primary" (click)="showDetailsIssuedLookup(dataItem)">{{dataItem.ISSUED_QTY}}</a>
                                </ng-template>
                            </kendo-grid-column>
                            <kendo-grid-column field="U_O_BALQTY" title="Quantity Balance" width="55" class="text-right" headerClass="text-right">
                            </kendo-grid-column>      
                            <kendo-grid-column field="U_O_ISSUEDATE" title="Issue Date" width="74">
                                <ng-template kendoGridCellTemplate let-dataItem>
                                    {{dataItem.U_O_ISSUEDATE | date: 'MM/dd/yyyy'}}
                                </ng-template>
                            </kendo-grid-column>
                            <kendo-grid-column field="U_O_ISSWH" title="Issue Warehouse" width="68" class="text-right" headerClass="text-right">
                            </kendo-grid-column>
                            <kendo-grid-column field="U_O_ISSBIN" title="Issue Bin" width="66">
                            </kendo-grid-column>
                            <kendo-grid-column field="U_O_ISSTYPE" title="Issue Method" width="70">
                            </kendo-grid-column>
                            <kendo-grid-column field="U_O_ISSTOOPER" title="Open#" width="46" class="text-right" headerClass="text-right">
                            </kendo-grid-column>                            
                            <kendo-grid-column-group headerClass="text-center"  title="Quantity at Warehouse XXXX" [width]="300">
                                <kendo-grid-column field="WH_INSTOCK_QTY" title="Quantity In Stock" [width]="81" class="text-right" headerClass="text-right">  
                                    <ng-template kendoGridCellTemplate let-dataItem>
                                        <a class="cursor-pointer text-primary" (click)="showDetailsInStockLookup(dataItem,'WH')">{{dataItem.WH_INSTOCK_QTY}}</a>
                                    </ng-template>                                  
                                </kendo-grid-column>
                                <kendo-grid-column field="WH_COMMITED_QTY" title="Quantity Commited" [width]="81" class="text-right" headerClass="text-right">
                                </kendo-grid-column>
                                <kendo-grid-column field="WH_ONORDER_QTY" title="Quantity On Order" [width]="86" [locked]="false" class="text-right" headerClass="text-right">
                                    <ng-template kendoGridCellTemplate let-dataItem>
                                        <a class="cursor-pointer text-primary" (click)="showDetailsOnOrderLookup(dataItem,'WH')" >{{dataItem.WH_ONORDER_QTY}}</a>
                                    </ng-template>
                                </kendo-grid-column>
                                <kendo-grid-column field="WH_AVAILABLE_QTY" title="Quantity Available" [width]="61" [locked]="false" class="text-right" headerClass="text-right">
                                </kendo-grid-column>
                            </kendo-grid-column-group>
                            <kendo-grid-column-group headerClass="text-center" title="Quantities at Company Level" [width]="300">
                                <kendo-grid-column field="COM_INSTOCK_QTY" title="Quantity In Stock" [width]="81" class="text-right" headerClass="text-right">    
                                    <ng-template kendoGridCellTemplate let-dataItem>
                                        <a class="cursor-pointer text-primary" (click)="showDetailsInStockLookup(dataItem,'CP')">{{dataItem.COM_INSTOCK_QTY}}</a>
                                    </ng-template>                                 
                                </kendo-grid-column>
                                <kendo-grid-column field="COM_COMMITED_QTY" title="Quantity Commited" [width]="81" class="text-right" headerClass="text-right">
                                </kendo-grid-column>
                                <kendo-grid-column field="COM_ONORDER_QTY" title="Quantity On Order" [width]="86" [locked]="false" class="text-right" headerClass="text-right">
                                    <ng-template kendoGridCellTemplate let-dataItem>
                                        <a class="cursor-pointer text-primary" (click)="showDetailsOnOrderLookup(dataItem,'CP')">{{dataItem.COM_ONORDER_QTY}}</a>
                                    </ng-template>
                                </kendo-grid-column>
                                <kendo-grid-column field="COM_AVAILABLE_QTY" title="Quantity Available" [width]="61" [locked]="false" class="text-right" headerClass="text-right">
                                </kendo-grid-column>
                            </kendo-grid-column-group>          
                        </kendo-grid>
                        </div>
                        <div class="mt-4" *ngIf="showMaterialView == 'all'">
                            <kendo-grid [kendoGridBinding]="gridMaterial" [selectable]="selectableSettings" [filterable]=isColumnFilter4
                              [groupable]=isColumnGroup [pageable]="true" [pageSize]="10" [selectable]="true" [sort]="state.sort" [filter]="state.filter" [resizable]="true"
                              (selectionChange)="gridRowSelectionChange($event,ref)"
                              [ngStyle]="{ 'max-height':'490px'}">
                              <ng-template kendoGridToolbarTemplate>
                                <form class="k-form opti_show-hide-grid-column-filter float-left opti_hide-in-mobile pl-0 pt-0">
                                  <div class="k-form-field d-flex">
                                    <input #chkFilter4 type="checkbox" (change)="onFilterChange(chkFilter4,gridMaterial)"
                                      id="opti_SalesOrderListColumnFilterID4" [(ngModel)]="isColumnFilter4" class="k-checkbox"
                                      name="columnfilter" />
                                    <label class="k-checkbox-label" for="opti_SalesOrderListColumnFilterID4">Enable Filter</label>
                                  </div>
                                </form>                
                              </ng-template>
  
                              <kendo-grid-checkbox-column *ngIf="showSelection==true" title="Select" [width]="25">
                                <ng-template kendoGridCellTemplate let-idx='rowIndex' let-di='dataItem'>
                                  <div class="k-form-field d-flex center-checkbox">
                                    <input #chkSelection type="checkbox" [disabled]='di.OldData' [checked]='di.OldData'
                                      (change)="onCheckboxClick(chkSelection.checked,idx)" id="chkbox-{{idx}}" class="k-checkbox"
                                      name="columnfilter" />      
                                    <label class="k-checkbox-label" for="chkbox-{{idx}}"></label>
                                  </div>
                                </ng-template>
                              </kendo-grid-checkbox-column>
  
                              <kendo-grid-column field="COMPONENT_WO" title="WO#" width="43">
                              </kendo-grid-column>      
                              <kendo-grid-column field="PARENT_ITEM_CODE" title="Parent FG" width="70">
                              </kendo-grid-column>
                              <kendo-grid-column field="PARENT_ITEM_DESC" title="Description" width="78">
                              </kendo-grid-column>
                              <kendo-grid-column field="U_O_COMPID" title="Component" width="80">
                              </kendo-grid-column>
                              <kendo-grid-column field="U_O_ITEMDESC" title="Description" width="78">
                              </kendo-grid-column>
                              <kendo-grid-column field="U_O_UOM" title="UOM" width="44">
                              </kendo-grid-column>      
                              <kendo-grid-column field="REQ_QTY" title="Quantity Request" width="59">
                              </kendo-grid-column>
                              <kendo-grid-column field="U_O_ACTISSQTY" title="Quantity Issue" width="74">
                                  <ng-template kendoGridCellTemplate let-dataItem>
                                      <a class="cursor-pointer text-primary" (click)="showDetailsIssuedLookup(dataItem)">{{dataItem.ISSUED_QTY}}</a>
                                  </ng-template>
                              </kendo-grid-column>
                              <kendo-grid-column field="U_O_BALQTY" title="Quantity Balance" width="55">
                              </kendo-grid-column>
                              <kendo-grid-column field="U_O_ISSUEDATE" title="Issue Date" width="74">
                                  <ng-template kendoGridCellTemplate let-dataItem>
                                      {{dataItem.U_O_ISSUEDATE | date: 'MM/dd/yyyy'}}
                                  </ng-template>
                              </kendo-grid-column>
                              <kendo-grid-column field="U_O_ISSWH" title="Issue Warehouse" width="68">
                              </kendo-grid-column>   
                              <kendo-grid-column field="U_O_ISSBIN" title="Issue Bin" width="66">
                              </kendo-grid-column> 
                              <kendo-grid-column field="U_O_ISSTYPE" title="Issue Method" width="70">
                              </kendo-grid-column>     
                              <kendo-grid-column field="U_O_ISSTOOPER" title="Open#" width="46">
                              </kendo-grid-column>                       
                              <kendo-grid-column-group headerClass="text-center"  title="Quantities at Warehouse XXXX" [width]="300">
                                  <kendo-grid-column field="WH_INSTOCK_QTY" title="Quantity In Stock" [width]="81">
                                      <ng-template kendoGridCellTemplate let-dataItem>
                                          <a class="cursor-pointer text-primary" (click)="showDetailsInStockLookup(dataItem,'WH')">{{dataItem.WH_INSTOCK_QTY}}</a>
                                      </ng-template>                                     
                                  </kendo-grid-column>
                                  <kendo-grid-column field="WH_COMMITED_QTY" title="Quantity Commit" [width]="81" >
                                  </kendo-grid-column>
                                  <kendo-grid-column field="WH_ONORDER_QTY" title="Quantity On Order" [width]="86" [locked]="false">
                                      <ng-template kendoGridCellTemplate let-dataItem>
                                          <a class="cursor-pointer text-primary" (click)="showDetailsOnOrderLookup(dataItem,'CP')">{{dataItem.WH_ONORDER_QTY}}</a>
                                      </ng-template>
                                  </kendo-grid-column>
                                  <kendo-grid-column field="WH_AVAILABLE_QTY" title="Quantity Available" [width]="61" [locked]="false">
                                  </kendo-grid-column>
                              </kendo-grid-column-group>
                              <kendo-grid-column-group headerClass="text-center" title="Quantity at Company Lvl" [width]="300">
                                  <kendo-grid-column field="COM_INSTOCK_QTY" title="Quantity In Stock" [width]="81">  
                                      <ng-template kendoGridCellTemplate let-dataItem>
                                          <a class="cursor-pointer text-primary" (click)="showDetailsInStockLookup(dataItem,'CP')">{{dataItem.COM_INSTOCK_QTY}}</a>
                                      </ng-template>                                  
                                  </kendo-grid-column>
                                  <kendo-grid-column field="COM_COMMITED_QTY" title="Quantity Commited" [width]="81" >
                                  </kendo-grid-column>
                                  <kendo-grid-column field="COM_ONORDER_QTY" title="Quantity On Order" [width]="86" [locked]="false">
                                      <ng-template kendoGridCellTemplate let-dataItem>
                                          <a class="cursor-pointer text-primary" (click)="showDetailsOnOrderLookup(dataItem,'CP')">{{dataItem.COM_ONORDER_QTY}}</a>
                                      </ng-template>
                                  </kendo-grid-column>
                                  <kendo-grid-column field="COM_AVAILABLE_QTY" title="Quantity Available" [width]="61" [locked]="false">
                                  </kendo-grid-column>
                              </kendo-grid-column-group> 
            
                          </kendo-grid>
                          </div>
                      </div>
                    </nb-tab>

                    <nb-tab tabTitle="Operations" [nbSpinner]="Tabloading" nbSpinnerStatus="primary" nbSpinnerSize="xxlarge"
                    nbSpinnerMessage="Please Wait">
                      <div class="py-3 px-2">
                        <div class="">
                          <kendo-grid [kendoGridBinding]="gridOperation" [selectable]="selectableSettings" [filterable]=isColumnFilter5
                            [groupable]=isColumnGroup [pageable]="true" [pageSize]="10" [selectable]="true" [sort]="state.sort" [filter]="state.filter" [resizable]="true"
                            (selectionChange)="gridRowSelectionChange($event,ref)"
                            [ngStyle]="{ 'max-height':'490px'}">
                            <ng-template kendoGridToolbarTemplate>
                              <form class="k-form opti_show-hide-grid-column-filter float-left opti_hide-in-mobile pl-0 pt-0">
                                <div class="k-form-field d-flex">
                                  <input #chkFilter5 type="checkbox" (change)="onFilterChange(chkFilter5,gridOperation)"
                                    id="opti_OperationsListColumnFilterID5" [(ngModel)]="isColumnFilter5" class="k-checkbox"
                                    name="columnfilter" />
                                  <label class="k-checkbox-label" for="opti_OperationsListColumnFilterID5">Enable Filter</label>
                                </div>
                              </form>
                
                            </ng-template>
                            <kendo-grid-checkbox-column *ngIf="showSelection==true" title="Select" [width]="25">
                              <ng-template kendoGridCellTemplate let-idx='rowIndex' let-di='dataItem'>
                                <div class="k-form-field d-flex center-checkbox">
                                  <input #chkSelection type="checkbox" [disabled]='di.OldData' [checked]='di.OldData'
                                    (change)="onCheckboxClick(chkSelection.checked,idx)" id="chkbox-{{idx}}" class="k-checkbox"
                                    name="columnfilter" />      
                                  <label class="k-checkbox-label" for="chkbox-{{idx}}"></label>
                                </div>
                              </ng-template>
                            </kendo-grid-checkbox-column>
                
                            <kendo-grid-column field="U_O_OPERNO" title="Open#" width="45" class="text-right" headerClass="text-right">
                            </kendo-grid-column>      
                            <kendo-grid-column field="U_O_OPR_ID" title="Open Code" width="70">
                            </kendo-grid-column>
                            <kendo-grid-column field="U_O_OPR_DESC" title="Open Description" width="69">
                            </kendo-grid-column>
                            <kendo-grid-column field="U_O_OPERCMPFLG" title="Open Complete" width="81">
                            </kendo-grid-column>
                            <kendo-grid-column field="U_OPTM_OPSDATE" title="Open Start Date/Time" width="115">
                              <ng-template kendoGridCellTemplate let-dataItem>
                                  {{dataItem.U_OPTM_OPSDATE | date: 'MM/dd/yyyy'}}
                              </ng-template>
                            </kendo-grid-column>
                            <kendo-grid-column field="U_OPTM_OPEDATE" title="Open End Date/Time" width="109">
                              <ng-template kendoGridCellTemplate let-dataItem>
                                  {{dataItem.U_OPTM_OPEDATE | date: 'MM/dd/yyyy'}}
                              </ng-template>
                            </kendo-grid-column>      
                            <kendo-grid-column field="U_O_OPR_TYPE" title="Open Type" width="68">
                            </kendo-grid-column>
                            <kendo-grid-column field="U_OPTM_TIME_UOM" title="UOM" width="44" class="text-right" headerClass="text-right">
                            </kendo-grid-column>
                            <kendo-grid-column field="U_O_BALQTY" title="Quantity Balance" width="55" class="text-right" headerClass="text-right">
                            </kendo-grid-column>
                            <kendo-grid-column field="U_O_CUMPRDCDQTY" title="Quantity Comm. Production" width="105" class="text-right" headerClass="text-right">
                            </kendo-grid-column>
                            <kendo-grid-column field="U_O_CUMINSPQTY" title="Quantity Inspection" width="61" class="text-right" headerClass="text-right">
                            </kendo-grid-column>      
                            <kendo-grid-column field="U_O_CUMPASSEDQTY" title="Quantity Pass" width="65" class="text-right" headerClass="text-right">
                            </kendo-grid-column>
                            <kendo-grid-column field="U_O_CUMREJQTY" title="Quantity Reject" width="71" class="text-right" headerClass="text-right">
                            </kendo-grid-column>
                            <kendo-grid-column field="U_O_CUMNCQTY" title="Quantity Comm. NC" width="96" class="text-right" headerClass="text-right">
                            </kendo-grid-column>
                            <kendo-grid-column field="U_O_REWORKQTY" title="Quantity Comm. Rework" width="120" class="text-right" headerClass="text-right">
                            </kendo-grid-column>
                            <kendo-grid-column field="U_OPTM_SCQTY" title="Quantity Comm. SC" width="95" class="text-right" headerClass="text-right">
                            </kendo-grid-column>      
                            <kendo-grid-column field="U_OPTM_SCCOST" title="Sub-Contracting Cost" width="60" class="text-right" headerClass="text-right">
                            </kendo-grid-column>
                            <kendo-grid-column field="U_OPTM_WC_ID" title="Work Center" width="36">
                            </kendo-grid-column>          
                          </kendo-grid>
                        </div>
                      </div>
                    </nb-tab>

                    <nb-tab tabTitle="Resources" [nbSpinner]="Tabloading" nbSpinnerStatus="primary" nbSpinnerSize="xxlarge"
                    nbSpinnerMessage="Please Wait">
                      <div class="py-3 px-2">
                        <div class="">
                          <kendo-grid [kendoGridBinding]="gridResource" [selectable]="selectableSettings" [filterable]=isColumnFilter6
                            [groupable]=isColumnGroup [pageable]="true" [pageSize]="10" [selectable]="true" [sort]="state.sort" [filter]="state.filter" [resizable]="true"
                            (selectionChange)="gridRowSelectionChange($event,ref)"
                            [ngStyle]="{ 'max-height':'490px'}">
                            <ng-template kendoGridToolbarTemplate>
                              <form class="k-form opti_show-hide-grid-column-filter float-left opti_hide-in-mobile pl-0 pt-0">
                                <div class="k-form-field d-flex">
                                  <input #chkFilter6 type="checkbox" (change)="onFilterChange(chkFilter6,gridResource)"
                                    id="opti_ResourcesListColumnFilterID6" [(ngModel)]="isColumnFilter6" class="k-checkbox"
                                    name="columnfilter" />
                                  <label class="k-checkbox-label" for="opti_ResourcesListColumnFilterID6">Enable Filter</label>
                                </div>
                              </form>
                
                            </ng-template>
                            <kendo-grid-checkbox-column *ngIf="showSelection==true" title="Select" [width]="25">
                              <ng-template kendoGridCellTemplate let-idx='rowIndex' let-di='dataItem'>
                                <div class="k-form-field d-flex center-checkbox">
                                  <input #chkSelection type="checkbox" [disabled]='di.OldData' [checked]='di.OldData'
                                    (change)="onCheckboxClick(chkSelection.checked,idx)" id="chkbox-{{idx}}" class="k-checkbox"
                                    name="columnfilter" />      
                                  <label class="k-checkbox-label" for="chkbox-{{idx}}"></label>
                                </div>
                              </ng-template>
                            </kendo-grid-checkbox-column>
                
                            <kendo-grid-column field="U_O_RESID" title="Resource" width="66">
                            </kendo-grid-column>      
                            <kendo-grid-column field="U_O_RESDESC" title="Description" width="78">
                            </kendo-grid-column>
                            <kendo-grid-column field="RESOURCE_TYPE" title="Resource Type" width="96">
                            </kendo-grid-column>
                            <kendo-grid-column field="NO_OF_RESOURCES" title="No. of Resource" width="100" class="text-right" headerClass="text-right">
                            </kendo-grid-column>
                            <kendo-grid-column field="USAGE_PER_BOM_QTY" title="Usage Per BOM Quantity" width="124" class="text-right" headerClass="text-right">
                            </kendo-grid-column>
                            <kendo-grid-column field="USAGE_BASIS" title="Usage Basis" width="83">
                            </kendo-grid-column>      
                            <kendo-grid-column field="TOTAL_USAGE" title="Total Usage" width="81" class="text-right" headerClass="text-right">
                            </kendo-grid-column>
                            <kendo-grid-column field="BAL_USAGE" title="Balance Usage" width="97" class="text-right" headerClass="text-right">
                            </kendo-grid-column>
                            <kendo-grid-column field="ACTUAL_USAGE" title="Actual Usage" width="88" class="text-right" headerClass="text-right">
                            </kendo-grid-column>
                            <kendo-grid-column field="PLANNED_RESOURCE" title="Planned Resource" width="114">
                            </kendo-grid-column>
                            <kendo-grid-column field="CONSUMPTION_TYPE" title="Consumption Type" width="118">
                            </kendo-grid-column>      
                            <kendo-grid-column field="U_O_WC_ID" title="Work Center Code" width="114">
                            </kendo-grid-column>
                            <kendo-grid-column field="U_O_UOM" title="UOM" width="44">
                            </kendo-grid-column>
                            <kendo-grid-column field="OPERATION" title="Operation #" width="80" class="text-right" headerClass="text-right">
                            </kendo-grid-column>        
                          </kendo-grid>
                        </div>
                      </div>
                    </nb-tab>
                  </nb-tabset>
                </nb-card-body>
              </nb-card>

              <!-- End Grid -->

            </div>

            <!-- End FG Grid-->


          </div>
        </nb-card-body>
      </nb-card>
    </div>
  </div>
  <div *ngIf="showLookup">
      <app-lookup [lookupfor]='lookupfor' [serviceData]='serviceApiData' (lookupvalue)="getLookupValue($event)"></app-lookup>
  </div>
</div>


